{%- for item in switch %}
    {
      "linkedItems": [
        "{{thingid}}_{{item.key|replace(".", "_")}}"          {# must match "name" definition in item #}
      ],
      "uid": "mqtt:topic:{{mqttUID}}:{{thingid}}:{{item.key|replace(".", "_")}}",
      "id": "{{item.label|replace(" ", "_")}}_{{item.key|replace(".", "_")}}",
      "channelTypeUID": "mqtt:switch",
      "itemType": "switch",
      "kind": "STATE",
      "label": "{{item.label}}",
      "description": "{{item.label}}",
      "defaultTags": [
        "{{item.tags}}"
      ],
      "properties": {
      },
      "configuration": {
        "retained": false,
        "postCommand": false,
        "formatBeforePublish": "%s",
        "commandTopic": "cmnd/{{topic}}/{{item.key|replace("Relay", "POWER")}}",
        "step": 1,
        {% if 'custom' in item.features %}
        "commandTopic": "cmnd/{{topic}}/{{item.key}}",
        "stateTopic": "stat/{{topic}}/RESULT",
        "transformationPattern": "REGEX:(.*{{item.key}}.*)\u2229JSONPATH:$.{{item.key}},"
        {% else %}
        "stateTopic": "stat/{{topic}}/RESULT",
        "transformationPattern": "REGEX:(.*{{item.key|replace("Relay", "POWER")}}.*)\u2229JSONPATH:$.{{item.key|replace("Relay", "POWER")}}",
        {% endif %}
        "off": "0",
        "on": "1"
      }
    },

{%- endfor %}